SET(PACKAGE_NAME NLL_LOCATOR)

SET(NLL_SOURCE_DIR ${SC3_PACKAGE_SOURCE_DIR}/libs/3rd-party/nll)
#AUX_SOURCE_DIRECTORY(${NLL_SOURCE_DIR} LIBNLL_SOURCES)
#AUX_SOURCE_DIRECTORY(${NLL_SOURCE_DIR}/alomax_matrix LIBNLL_ALOMAX_MATRIX_SOURCES)
FILE(GLOB LIBNLL_SOURCES ${NLL_SOURCE_DIR}/*.c)
FILE(GLOB LIBNLL_ALOMAX_MATRIX_SOURCES ${NLL_SOURCE_DIR}/alomax_matrix/*.c)
FILE(GLOB LIBNLL_ALOMAX_GEOMETRY_SOURCES ${NLL_SOURCE_DIR}/geometry/*.c)
FILE(GLOB LIBNLL_ALOMAX_STATS_SOURCES ${NLL_SOURCE_DIR}/matrix_statistics/*.c)
FILE(GLOB LIBNLL_ALOMAX_OCTTREE_SOURCES ${NLL_SOURCE_DIR}/octtree/*.c)
FILE(GLOB LIBNLL_ALOMAX_RAN1_SOURCES ${NLL_SOURCE_DIR}/ran1/*.c)
FILE(GLOB LIBNLL_ALOMAX_VECTOR_SOURCES ${NLL_SOURCE_DIR}/vector/*.c)

IF(MACOSX)
FILE(GLOB LIBNLL_OPEN_MEMSTREAM_OSX_SOURCES ${NLL_SOURCE_DIR}/open_memstream-osx/*.c)
ENDIF(MACOSX)

IF(NOT ${CMAKE_SYSTEM_NAME} MATCHES "Darwin")
	IF (CMAKE_COMPILER_IS_GNUCC)
	ADD_DEFINITIONS(-D_GNU_SOURCE)
	ENDIF (CMAKE_COMPILER_IS_GNUCC)
ELSE(NOT ${CMAKE_SYSTEM_NAME} MATCHES "Darwin")
	ADD_DEFINITIONS(-DINLINE=\"\")
ENDIF(NOT ${CMAKE_SYSTEM_NAME} MATCHES "Darwin")

IF(LINUX)
SET( ${PACKAGE_NAME}_SOURCES
	${LIBNLL_SOURCES}
	${LIBNLL_ALOMAX_MATRIX_SOURCES}
	${LIBNLL_ALOMAX_GEOMETRY_SOURCES}
	${LIBNLL_ALOMAX_STATS_SOURCES}
	${LIBNLL_ALOMAX_OCTTREE_SOURCES}
	${LIBNLL_ALOMAX_RAN1_SOURCES}
	${LIBNLL_ALOMAX_VECTOR_SOURCES}
	nll_locator.cpp
)
ENDIF(LINUX)

IF(MACOSX)
SET( ${PACKAGE_NAME}_SOURCES
	${LIBNLL_SOURCES}
	${LIBNLL_ALOMAX_MATRIX_SOURCES}
	${LIBNLL_ALOMAX_GEOMETRY_SOURCES}
	${LIBNLL_ALOMAX_STATS_SOURCES}
	${LIBNLL_ALOMAX_OCTTREE_SOURCES}
	${LIBNLL_ALOMAX_RAN1_SOURCES}
	${LIBNLL_ALOMAX_VECTOR_SOURCES}
    ${LIBNLL_OPEN_MEMSTREAM_OSX_SOURCES}
	nll_locator.cpp
)
ENDIF(MACOSX)

SET(${PACKAGE_NAME}_HEADERS nll_locator.h)

IF(MACOSX)
SET(${PACKAGE_NAME}_HEADERS nll_locator.h open_memstream.h fmemopen.h)
ENDIF(MACOSX)

INCLUDE_DIRECTORIES(${NLL_SOURCE_DIR})
INCLUDE_DIRECTORIES(${NLL_SOURCE_DIR}/geometry)
INCLUDE_DIRECTORIES(${NLL_SOURCE_DIR}/ran1)

INCLUDE_DIRECTORIES(${CMAKE_CURRENT_SOURCE_DIR})
INCLUDE_DIRECTORIES(${CMAKE_CURRENT_INCLUDE_DIR})

IF(MACOSX)
INCLUDE_DIRECTORIES(${NLL_SOURCE_DIR}/open_memstream-osx)
ENDIF(MACOSX)

SC_ADD_PLUGIN_LIBRARY(${PACKAGE_NAME} locnll "")
SC_LINK_LIBRARIES_INTERNAL(locnll core)

IF(MACOSX)
SC_LINK_LIBRARIES_INTERNAL(locnll core)
ENDIF(MACOSX)

FILE(GLOB descs "${CMAKE_CURRENT_SOURCE_DIR}/descriptions/*.xml")
INSTALL(FILES ${descs} DESTINATION ${SC3_PACKAGE_APP_DESC_DIR})
